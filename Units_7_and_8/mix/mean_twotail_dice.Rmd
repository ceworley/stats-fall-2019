```{r data generation, echo = FALSE, results = "hide"}
## DATA GENERATION
library(latex2exp)
options(scipen=999)
alphas = c(0.1,0.05,0.025,0.02,0.01)
alpha = sample(alphas,1)
ell = alpha/2
zstar = abs(qnorm(ell))
sides = sample(c(4,6,8,10,12,20),1)
mu = round((sides+1)/2,1)
sig = round(sqrt((sides^2-1)/12),2)
n = sample(80:300, 1)
se = round(sig/sqrt(n), 3)
while(T){
  z = round(runif(1,zstar-0.3,zstar+0.3),2)*sample(c(-1,1),1)
  xbar = mu+z*se
  tot = xbar*n
  xbar = round(tot/n,3)
  z = round((xbar-mu)/sig*sqrt(n),2)
  if(abs(z-zstar)>0.02){break}
}
pvalue = 2*round(pnorm(-abs(z)),4)
if(pvalue < alpha){
  w = "Yes, we reject the null hypothesis."
  sym = "<"
  ans = "We conclude the die is unfair."
} else {
  w = "No, we do not reject the null hypothesis."
  sym = ">"
  ans = "We conclude the die might be fair."
}
```

Question
========

A fair `r sides`-sided die has a discrete uniform distribution with an expected value of $\mu = `r mu`$ and a standard deviation $\sigma = `r sig`$.

You are told to check if a `r sides`-sided die has an expected value different than `r mu`. You are told to roll the die `r n` times and do a significance test with a significance level of `r alpha`.

You then roll the die `r n` times and get a mean of `r xbar`. Should we conclude the die is unfair?

Answerlist
--------
* What kind of hypothesis test is appropriate?
* State the hypotheses
* Determine the $p$-value.
* Decide whether we reject or retain the null hypothesis.
* Do we conclude the die is unfair?


Solution
========

We should use a two-tail test of population mean.

State the hypotheses:
$$H_0 ~~ \text{ claims } ~~ \mu=`r mu` $$
$$H_A ~~\text{ claims }~~\mu\ne`r mu`$$

Find the standard error.
$$\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}} = \frac{`r sig`}{\sqrt{`r n`}} = `r se` $$
Make a sketch of the null's sampling distribution.
\
```{r pvalue_sketch_ttdice, echo = FALSE, results = "hide", fig.height = 3, fig.width = 7, fig.cap = ""}
par(mar=c(5,3,1,1))
zs = seq(-3,3,length=1000)
ys = dnorm(zs)
plot(zs, ys, 'l',xlim = c(-3,3), ylim = c(0,0.4),
     ann=FALSE,xaxt="n",yaxt="n",
     lwd=1,bty='n')
axis(side=1, line=0, at=-3:3, labels = FALSE)
mtext(mu+(-3:3)*se,side=1,line=0.5,at=-3:3)
mtext(TeX("\\bar{x}="),line=0.5,side=1,at=-3.5)
axis(side=1, line=2,at=-3:3, labels = FALSE)
mtext(-3:3,side=1,line=2.5,at=-3:3)
mtext(c("z="),line=2.5,side=1,at=-3.5)
polygon(c(zs[zs<=-abs(z)], -abs(z), -3),c(ys[zs<=-abs(z)], 0, 0), col=rgb(1,0,0,0.5))
polygon(c(zs[zs>=abs(z)], 3, abs(z)),c(ys[zs>=abs(z)], 0, 0), col=rgb(1,0,0,0.5))
lines(c(-3,3),c(0,0),'l')
text(-2,0.3,label="two-tail area = pvalue")
```

Find the $z$ score.
$$z = \frac{\bar{x}-\mu_0}{\sigma_{\bar{x}}} = \frac{`r xbar`-`r mu`}{`r se`} = `r z`$$

Find the $p$-value (using formula for left-tail test of mean).
$$\begin{aligned}
p\text{-value} &= P(|Z| > `r abs(z)`) \\
               &= 2\cdot P(Z<`r -abs(z)`) \\
               &= \fbox{`r pvalue`}
\end{aligned}$$
Compare the $p$-value and the significance level ($\alpha = `r alpha`$).
$$p\text{-value} `r sym` \alpha $$
`r w`

`r ans`

Answerlist
--------
* Right-tail single mean test
* Hypotheses: $H_0\text{ claims }\mu=`r mu`$ and $H_A\text{ claims }\mu\ne`r mu`$.
* $p$-value = `r pvalue`
* `r w`
* `r ans`



Meta-information
============
extype: num
exsolution: `r pvalue`
exname: binomial exact
extol: 0.01
