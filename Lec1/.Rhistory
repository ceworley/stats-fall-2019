install.packages("plot3D")
##  Plot as a 3D histogram:
hist3D(z=z, phi = 5, theta = -45, xlab="spin", ylab="running average",zlab="relative frequency",border=rgb(0,0,0),lwd=1,r=3,d=1.1,resfac=10)
library(plot3D)
set.seed(123)
#plot(0,0,xlim = c(0,100),ylim = c(0,60),type = "n", main="1000 overlapped running averages", ylab="running average", xlab="spin")
allavgs = numeric()
xs = numeric()
for(i in 1:1000){
hits = sample(c(5,15,60), 100, replace=TRUE, prob=c(0.5,0.3,0.2))
avgs = cumsum(hits) / (1:length(hits))
#  points(avgs, col=rgb(0,0,0,0.01))
allavgs = c(allavgs, avgs)
xs = c(xs, 1:100)
}
##  Simulate data:
set.seed(2002)
x <- xs
y <- allavgs
##  Create cuts:
x_c <- cut(x, 100)
y_c <- cut(y, 56)
##  Calculate joint counts at cut levels:
z <- table(x_c, y_c)/1000
par(mar = c(1,0,0,5))
##  Plot as a 3D histogram:
hist3D(z=z, phi = 5, theta = -45, xlab="spin", ylab="running average",zlab="relative frequency",border=rgb(0,0,0),lwd=1,r=3,d=1.1,resfac=10)
library(plot3D)
set.seed(123)
#plot(0,0,xlim = c(0,100),ylim = c(0,60),type = "n", main="1000 overlapped running averages", ylab="running average", xlab="spin")
allavgs = numeric()
xs = numeric()
for(i in 1:1000){
hits = sample(c(5,15,60), 100, replace=TRUE, prob=c(0.5,0.3,0.2))
avgs = cumsum(hits) / (1:length(hits))
#  points(avgs, col=rgb(0,0,0,0.01))
allavgs = c(allavgs, avgs)
xs = c(xs, 1:100)
}
##  Simulate data:
set.seed(2002)
x <- xs
y <- allavgs
##  Create cuts:
x_c <- cut(x, 100)
y_c <- cut(y, 56)
##  Calculate joint counts at cut levels:
z <- table(x_c, y_c)/1000
par(mar = c(1,0,0,5))
##  Plot as a 3D histogram:
hist3D(z=z, phi = 5, theta = -45, xlab="spin", ylab="running average",zlab="relative frequency",border=rgb(0,0,0),lwd=1,r=3,d=1.1,resfac=10)
